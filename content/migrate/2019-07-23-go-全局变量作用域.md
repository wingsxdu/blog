---
title: Go 全局变量作用域
author: beihai
type: post
date: 2019-07-23T10:55:16+00:00
url: /?p=1357
categories:
  - Golang
  - 技术向

---
##### 问题所在

<span>全局变量的作用域是整个包，局部变量的作用域是该变量所在的花括号内。最近使用 gorm 时遇到了使用全局变量赋值作用域的问题。</span>

<pre class="pure-highlightjs"><code class="null">var db *gorm.DB // 全局变量用 =

func Init() {
	db, err := gorm.Open("mysql", "//")
	debug.CheckErr(err)
	//defer db.Close()
}
</code></pre>

如果使用语法糖 := 赋值，全局变量 db 的作用域只在 Init{} 函数内，其他函数内调用会报错空指针。

因此若避免全局变量变成局部变量，应采用 “=&#8221; 写法：

<pre class="pure-highlightjs"><code class="null">var db *gorm.DB // 全局变量用 =

func Init() {
	var err error
	db, err = gorm.Open("mysql", "//")
	debug.CheckErr(err)
	//defer db.Close()
}
</code></pre>

&nbsp;

此时 db 可在包内的其他函数中调用